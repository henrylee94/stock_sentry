# GEEWONI Stock Sentry

AI trading assistant: Telegram bot (with 9 AM news), multi-agent strategies, and Streamlit backoffice.

---

## How to run (2 processes)

You have **2** things to run (not 3): the **scheduler runs inside the bot**.

| What | Command | Notes |
|------|--------|------|
| **1. Bot + News scheduler** | `python telegram_bot.py` | Handles Telegram messages and sends 9 AM Malaysia news digest in the same process |
| **2. Backoffice (Tradesniper)** | `streamlit run tradesniper.py` | Dashboard: config, trades, analytics, settings |

Run both from this folder (`stock_sentry/`):

```bash
cd stock_sentry

# Terminal 1 – Bot (includes 9 AM news)
python telegram_bot.py

# Terminal 2 – Backoffice
streamlit run tradesniper.py
```

On Zeabur you typically run only the bot (`python telegram_bot.py`); the 9 AM job runs in that same process.

---

## Refresh US stock list (optional)

Symbol lookup supports company names and partial spelling (e.g. "amazon", "amazo" → AMZN) in both the Telegram bot and the dashboard. To rebuild the alias list:

**Option A – use your own NASDAQ screener CSV**  
Place a file named `nasdaq_screener_*.csv` in the project root (columns **Symbol** and **Name**). Then run:

```bash
python scripts/update_stock_list.py
```

The script will use the most recent matching CSV and write `stock_aliases.json`.

**Option B – no CSV**  
If no `nasdaq_screener_*.csv` exists, the script tries to download from NASDAQ/NYSE URLs; if that fails, it writes a small fallback list.

Add `stock_aliases_override.json` (e.g. `{"amazo": "AMZN", "appl": "AAPL"}`) to add or override aliases; it is merged when you run the script.

---

## Env vars

In `.env` (or Zeabur env):

- `TELEGRAM_TOKEN` – Production bot (Zeabur)
- `TELEGRAM_TOKEN_LOCAL` – Optional; use this bot when set (local dev)
- `TELEGRAM_CHAT_ID` – Where to send 9 AM news and alerts
- `OPENAI_KEY` – For AI and news summarization
- `FINNHUB_API_KEY` – Optional; real-time quotes (fallback: Yahoo)

---

## Folder layout (outer layer)

```
stock_sentry/
├── telegram_bot.py          # Bot entry (includes news scheduler)
├── tradesniper.py           # Backoffice entry
├── intent_detector.py       # Symbol resolution + intent (bot & backoffice)
├── rules_engine.py          # AI rules loader
├── requirements.txt
├── core/                    # Config, data manager, rate limiting
├── news/                    # News fetch + 9 AM scheduler
├── dashboard_components/    # Charts for backoffice
├── ai_rules/                # AI rule files (incl. personal_preference.md)
├── skills/                  # Strategy skills (JSON)
├── strategy_agents/         # Per-strategy evaluators (base_agent); backtester.py at root is the engine, agents/backtester_agent.py wraps it
├── scripts/                 # update_stock_list.py → builds stock_aliases.json
├── docs/                    # Guides (snake_case filenames); docs/planning/ for requirement & Q&A
├── agents/                  # Pipeline: analyzer, technical_analyst, strategy_generator, backtester_agent, final_decision, tools
├── geewoni_config.json      # Runtime config (watchlist, goals, etc.)
├── stock_aliases_override.json  # Extra symbol aliases (optional)
├── stock_aliases.json       # Generated by scripts/update_stock_list.py (gitignored)
├── strategies.json
└── trades_history.json
```

Full guides: see **docs/** (e.g. `startup_guide.md`, `complete_integration_guide.md`, `fixes_quick_reference.md`, `tradesniper_guide.md`). Architecture overview: **docs/ARCHITECTURE.md**. Planning and Q&A: **docs/planning/** (`new_requirement.md`, `user_qna.md`).
